---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("writing")).sort(
    (a, b) => (b.data.date?.valueOf() || 0) - (a.data.date?.valueOf() || 0),
);
---

<Layout title="Writing | Nony">
    <main class="writing-container">
        <header class="editorial-header">
            <span class="sub">Stories & Essays</span>
            <h1>The Archives</h1>
        </header>

        <section class="posts-list">
            {
                posts.map((post) => (
                    <a href={`/writing/${post.slug}`} class="post-row">
                        <span class="date">
                            {post.data.date.toLocaleDateString()}
                        </span>
                        <div class="info">
                            <h2>{post.data.title}</h2>
                            <p>{post.data.description}</p>
                        </div>
                        <span class="arrow">
                            <i class="fi fi-rr-arrow-right" />
                        </span>
                    </a>
                ))
            }
        </section>
    </main>
</Layout>

<style>
    .writing-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 8rem 2rem 4rem;
    }

    .editorial-header {
        margin-bottom: 5rem;
        border-bottom: 2px solid var(--color-text);
        padding-bottom: 2rem;
    }
    .sub {
        display: block;
        font-family: "Fira Code", monospace;
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
        opacity: 0.6;
        text-transform: uppercase;
    }
    .editorial-header h1 {
        font-family: "Fraunces", serif;
        font-size: 4rem;
        margin: 0;
        line-height: 1;
    }

    .posts-list {
        display: flex;
        flex-direction: column;
    }

    .post-row {
        display: flex;
        align-items: baseline;
        gap: 2rem;
        padding: 2.5rem 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        text-decoration: none;
        color: var(--color-text);
        transition: all 0.3s ease;
        group: row;
    }
    :global(.dark) .post-row {
        border-color: rgba(255, 255, 255, 0.1);
    }

    .post-row:hover {
        padding-left: 1rem;
        border-color: var(--color-primary);
    }

    .date {
        font-family: "Fira Code", monospace;
        font-size: 0.85rem;
        opacity: 0.5;
        width: 100px;
        flex-shrink: 0;
    }

    .info {
        flex-grow: 1;
    }
    .info h2 {
        font-family: "Fraunces", serif;
        font-size: 1.8rem;
        margin: 0 0 0.5rem 0;
        transition: color 0.3s;
    }
    .info p {
        margin: 0;
        font-size: 1rem;
        opacity: 0.7;
        font-family: "Crimson Text", serif;
    }

    .post-row:hover .info h2 {
        color: var(--color-primary);
    }

    .arrow {
        opacity: 0;
        transform: translateX(-10px);
        transition: all 0.3s;
    }
    .post-row:hover .arrow {
        opacity: 1;
        transform: translateX(0);
    }

    @media (max-width: 600px) {
        .post-row {
            flex-direction: column;
            gap: 0.5rem;
            align-items: flex-start;
        }
        .date {
            width: auto;
            margin-bottom: 0.5rem;
        }
        .arrow {
            display: none;
        }
    }
</style>
